<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãªã”ã‚„å»ºç¯‰ã¾ã¤ã‚Šãƒ•ã‚©ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ </title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div id="camera-container">
  <video id="camera" autoplay playsinline></video>
  <img id="frame" src="frames/frame1.png" alt="ãƒ•ã‚©ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ">
  <canvas id="canvas" style="display:none;"></canvas>
  <button id="capture-button">ğŸ“¸ æ’®å½±</button>
  <div id="share-area">
    <p>#ãªã”ã‚„å»ºç¯‰ã¾ã¤ã‚Š2025</p>
    <button id="instagram-button">Instagramã§æŠ•ç¨¿</button>
  </div>
</div>

<script>
const video = document.getElementById('camera');
const canvas = document.getElementById('canvas');
const frame = document.getElementById('frame');
const captureButton = document.getElementById('capture-button');
const instagramButton = document.getElementById('instagram-button');

let frameNum = 1; // è¡¨ç¤ºã—ãŸã„ãƒ•ãƒ¬ãƒ¼ãƒ ç•ªå·ï¼ˆ1ã€œ25ï¼‰
frame.src = `frames/frame${frameNum}.png`;

// ã‚«ãƒ¡ãƒ©èµ·å‹•
async function startCamera() {
  try {
    const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } });
    video.srcObject = stream;
  } catch (err) {
    alert("ã‚«ãƒ¡ãƒ©ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“: " + err);
  }
}
startCamera();

// æ’®å½±
captureButton.addEventListener('click', () => {
  const frameAspect = 5 / 4; // ç¸¦å‹5:4
  const height = video.videoHeight;
  const width = height / frameAspect;

  canvas.width = width;
  canvas.height = height;
  const ctx = canvas.getContext('2d');

  const sx = (video.videoWidth - width) / 2;
  ctx.drawImage(video, sx, 0, width, height, 0, 0, width, height);
  ctx.drawImage(frame, 0, 0, width, height);

  // è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  const link = document.createElement('a');
  link.download = `photo_frame.png`;
  link.href = canvas.toDataURL('image/png');
  link.click();
});

// InstagramæŠ•ç¨¿èª˜å°
instagramButton.addEventListener('click', () => {
  const hashtag = "ãªã”ã‚„å»ºç¯‰ã¾ã¤ã‚Š2025";
  const url = `https://www.instagram.com/explore/tags/${encodeURIComponent(hashtag)}/`;
  window.open(url, "_blank");
});
</script>
</body>
</html>
